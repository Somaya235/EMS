<app-header></app-header>

<div class="activity-details-container">
  <!-- Loading State -->
  <div *ngIf="loading" class="loading-state">
    <div class="loading-spinner"></div>
    <p>Loading activity details...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error" class="error-state">
    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <circle cx="12" cy="12" r="10"></circle>
      <line x1="12" y1="8" x2="12" y2="12"></line>
      <line x1="12" y1="16" x2="12.01" y2="16"></line>
    </svg>
    <h3>Unable to Load Activity</h3>
    <p>{{ error }}</p>
  </div>

  <!-- Activity Details -->
  <div *ngIf="activity$ | async as activity; else loadingOrError" class="activity-content">
    <!-- Header Section -->
    <div class="activity-header">
      <div class="header-left">
        <h1 class="activity-title">{{ activity.name }}</h1>
        <div class="activity-meta">
          <span class="category-badge" [style.background-color]="getCategoryColor(activity.category)">
            {{ activity.category }}
          </span>
          <span class="status-badge" [class.active]="activity.isActive">
            {{ activity.isActive ? 'Active' : 'Inactive' }}
          </span>
        </div>
      </div>
    </div>

    <!-- Main Content -->
    <div class="activity-main">
      <!-- Left Content Container -->
        <div class="content-left">
          <!-- Description Card -->
          <div class="info-card">
            <h2 class="card-title">About this Activity</h2>
            <p class="activity-description">{{ activity.description || 'No description available for this activity.' }}</p>
          </div>
        </div>
      

      <!-- Right Sidebar -->
      <div class="content-right">
        <!-- Stats Card -->
        <div class="stats-card">
          <div class="stat-item">
            <div class="stat-number">{{ activity.memberCount || 0 }}</div>
            <div class="stat-label">Members</div>
          </div>
          <div class="stat-divider"></div>
          <div class="stat-item">
            <div class="stat-number">{{ activity.maxMembers || 'âˆž' }}</div>
            <div class="stat-label">Max Members</div>
          </div>
        </div>

        <!-- President Card -->
        <div class="president-card">
          <h3 class="card-title">Activity President</h3>
          <div class="president-info">
            <div class="president-avatar">
              {{ getPresidentInitials(activity.president?.fullName || '') }}
            </div>
            <div class="president-details">
              <div class="president-name">{{ activity.president?.fullName || 'No President' }}</div>
              <div class="president-role">Activity President</div>
              <button class="contact-btn">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
                  <polyline points="22,6 12,13 2,6"></polyline>
                </svg>
                Contact
              </button>
            </div>
          </div>
        </div>

        <!-- Actions Card -->
        <div class="actions-card">
          <button class="action-btn secondary" (click)="leaveActivity(activity.id)">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
              <circle cx="8.5" cy="7" r="4"></circle>
              <line x1="23" y1="11" x2="17" y2="11"></line>
            </svg>
            Leave Activity
          </button>
        </div>
      </div>
    </div>

    <!-- Committees Section -->
    <app-activity-committees [activityId]="activity.id"></app-activity-committees>
  </div>
</div>

<!-- Template references -->
<ng-template #loadingOrError>
  <div *ngIf="loading" class="loading-state">
    <div class="loading-spinner"></div>
    <p>Loading activity details...</p>
  </div>
  <div *ngIf="error" class="error-state">
    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <circle cx="12" cy="12" r="10"></circle>
      <line x1="12" y1="8" x2="12" y2="12"></line>
      <line x1="12" y1="16" x2="12.01" y2="16"></line>
    </svg>
    <h3>Unable to Load Activity</h3>
    <p>{{ error }}</p>
  </div>
</ng-template>
